import{b as z,r as o,c as _,j as e,S as B,t as D}from"./index-DKzGAutY.js";import{feedService as L}from"./feed-Brgwye14.js";import{G as N}from"./GameOverCard-DIKxrpgZ.js";const n=16,I=30,F=()=>{const{updateStat:i,addCoins:h,userProfile:G,stats:d}=z()||{},[l,f]=o.useState(new Array(n).fill(!1)),[a,g]=o.useState(0),[c,x]=o.useState(parseInt(localStorage.getItem("whackHighScore"))||0),[y,b]=o.useState(I);o.useEffect(()=>{d?.whackHighScore>c&&x(d.whackHighScore)},[d]);const[m,S]=o.useState(!1),[w,v]=o.useState(!1),{playJump:E,playWin:H}=_(),p=o.useRef(null),u=o.useRef(null),[k,O]=o.useState(new Array(n).fill("default")),W=()=>{if(clearInterval(u.current),clearTimeout(p.current),S(!1),v(!0),f(new Array(n).fill(!1)),H(),i&&i("gamesPlayed","whack"),a>c&&(x(a),i&&i("whackHighScore",a),D(),a>100)){const t=G?.name||"Player";L.publish(`is a Whack-a-Mole Champion! Score: ${a} ðŸ”¨`,"win",t)}h&&h(Math.floor(a/10))},M=()=>{const t=Math.random()*800+400;p.current=setTimeout(()=>{if(!m&&y<=0)return;[...l];const r=new Array(n).fill(!1),s=Math.floor(Math.random()*n);r[s]=!0,f(r);const R=["default","cat","bunny","money"],C=[...k];C[s]=R[Math.floor(Math.random()*R.length)],O(C),M()},t)},j=()=>{g(0),b(I),S(!0),v(!1),u.current=setInterval(()=>{b(t=>t<=1?(W(),0):t-1)},1e3),M()},T=t=>{if(!m||!l[t])return;g(s=>s+10),E(),navigator.vibrate&&navigator.vibrate(100);const r=[...l];r[t]=!1,f(r)};o.useEffect(()=>()=>{clearInterval(u.current),clearTimeout(p.current)},[]);const A={default:"/assets/merchboy_face.png",cat:"/assets/merchboy_cat.png",bunny:"/assets/merchboy_bunny.png",money:"/assets/merchboy_money.png"};return e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",padding:"10px",color:"#ff0055",width:"100%",minHeight:"100vh",touchAction:"manipulation"},children:[e.jsx("style",{children:`
                @keyframes spinMole {
                    0% { transform: rotate(0deg); }
                    25% { transform: rotate(-10deg); }
                    75% { transform: rotate(10deg); }
                    100% { transform: rotate(0deg); }
                }
                @keyframes fullSpin {
                    0% { transform: rotate(0deg) scale(1); }
                    50% { transform: rotate(180deg) scale(1.2); }
                    100% { transform: rotate(360deg) scale(1); }
                }
            `}),e.jsx("h1",{style:{fontFamily:'"Courier New", monospace',fontSize:"2.5rem",margin:"10px 0",textAlign:"center"},children:"WHACK-A-MOLE"}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",width:"100%",maxWidth:"500px",marginBottom:"20px",fontSize:"1.2rem",fontWeight:"bold"},children:[e.jsxs("span",{children:["SCORE: ",a]}),e.jsxs("span",{children:["TIME: ",y,"s"]}),e.jsxs("span",{children:["HIGH: ",c]})]}),!m&&!w&&e.jsx(B,{onClick:j,style:{padding:"15px 40px",fontSize:"1.5rem",backgroundColor:"#ff0055",color:"white",border:"none",borderRadius:"10px",boxShadow:"0 5px 0 #990033",marginBottom:"20px"},children:"START GAME"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"10px",padding:"10px",width:"100%",maxWidth:"600px",aspectRatio:"1/1",backgroundColor:"#2a2a40",borderRadius:"20px",border:"4px solid #ff0055",boxShadow:"0 0 20px #ff005540"},children:l.map((t,r)=>e.jsxs("div",{onMouseDown:()=>T(r),onTouchStart:s=>{s.preventDefault(),T(r)},style:{width:"100%",height:"100%",backgroundColor:"#151525",borderRadius:"15px",position:"relative",cursor:"pointer",overflow:"hidden",border:"2px solid #333",touchAction:"none",boxShadow:"inset 0 0 10px #000"},children:[e.jsx("div",{style:{position:"absolute",bottom:"10%",left:"10%",width:"80%",height:"25%",backgroundColor:"#000",borderRadius:"50%",opacity:.6}}),e.jsx("div",{style:{position:"absolute",bottom:t?"15%":"-100%",left:"0",width:"100%",height:"90%",backgroundImage:`url(${A[k[r]]||A.default})`,backgroundSize:"contain",backgroundRepeat:"no-repeat",backgroundPosition:"bottom center",transition:"bottom 0.1s cubic-bezier(0.175, 0.885, 0.32, 1.275)",animation:t?"fullSpin 2s linear infinite":"none",zIndex:10}})]},r))}),w&&e.jsx(N,{score:a,bestScore:c,gameId:"whack",onReplay:j,onHome:()=>window.location.href="/arcade"}),e.jsx("div",{style:{marginTop:"20px"},children:e.jsx("img",{src:"/assets/brokid-logo.png",alt:"Brokid",style:{width:"100px",opacity:.6}})})]})};export{F as default};
