import{r as x,j as t,S as E,c as B,t as U}from"./index-DKzGAutY.js";const q=u=>{const m=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(u);return m?{r:parseInt(m[1],16),g:parseInt(m[2],16),b:parseInt(m[3],16),a:255}:null},K=(u,m,j,v,p)=>{const l=u.canvas.width,d=u.canvas.height,f=u.getImageData(0,0,l,d),s=f.data,w=m.getImageData(0,0,l,d).data,y=q(p),i=(v*l+j)*4,c=s[i],g=s[i+1],I=s[i+2],R=s[i+3];if(c===y.r&&g===y.g&&I===y.b&&R===255)return;const T=C=>{const S=w[C],h=w[C+1],r=w[C+2];return w[C+3]>50&&S+h+r<300},z=[[j,v]];for(;z.length;){const C=z.pop(),S=C[0];let h=C[1],r=(h*l+S)*4;for(;h-->=0&&s[r]===c&&s[r+1]===g&&s[r+2]===I&&s[r+3]===R&&!T(r);)r-=l*4;r+=l*4,++h;let e=!1,o=!1;for(;h++<d-1&&s[r]===c&&s[r+1]===g&&s[r+2]===I&&s[r+3]===R&&!T(r);){if(s[r]=y.r,s[r+1]=y.g,s[r+2]=y.b,s[r+3]=255,S>0){const n=r-4;s[n]===c&&s[n+1]===g&&s[n+2]===I&&s[n+3]===R&&!T(n)?e||(z.push([S-1,h]),e=!0):e&&(e=!1)}if(S<l-1){const n=r+4;s[n]===c&&s[n+1]===g&&s[n+2]===I&&s[n+3]===R&&!T(n)?o||(z.push([S+1,h]),o=!0):o&&(o=!1)}r+=l*4}}u.putImageData(f,0,0)},_=["#ff0055","#00ffaa","#ffff00","#00ccff","#ff9900","#cc00ff","#ffffff","#000000"],P=[{type:"emoji",content:"â­"},{type:"emoji",content:"ðŸš€"},{type:"emoji",content:"ðŸŒˆ"},{type:"emoji",content:"ðŸ±"},{type:"emoji",content:"ðŸ•"},{type:"emoji",content:"ðŸ‘•"},{type:"emoji",content:"ðŸ§¢"},{type:"emoji",content:"ðŸ‘Ÿ"},{type:"emoji",content:"ðŸ•¶ï¸"},{type:"image",content:"/assets/boy-logo.png"},{type:"image",content:"/assets/brokid-logo.png"}],G=({templateImage:u,onComplete:m})=>{const j=x.useRef(null),v=x.useRef(null),p=x.useRef(null),[l,d]=x.useState("bucket"),[f,s]=x.useState("#ff0055"),[k,w]=x.useState(P[0]),[y,i]=x.useState(10),[c,g]=x.useState(!1);x.useEffect(()=>{if(!u)return;const e=v.current,o=p.current,n=e.getContext("2d"),a=o.getContext("2d",{willReadFrequently:!0}),L=new Image;L.src=u,L.crossOrigin="anonymous",L.onload=()=>{const W=j.current,b=Math.min(W.clientWidth,500);e.width=b,e.height=b,o.width=b,o.height=b,n.drawImage(L,0,0,b,b);const O=n.getImageData(0,0,b,b),M=O.data;for(let D=0;D<M.length;D+=4){const F=M[D],A=M[D+1],N=M[D+2];F>200&&A>200&&N>200&&(M[D+3]=0)}n.putImageData(O,0,0),a.fillStyle="#ffffff",a.fillRect(0,0,b,b)}},[u]);const I=e=>{g(!0);const{x:o,y:n}=z(e);l==="bucket"?(C(o,n),g(!1)):l==="sticker"?(S(o,n),g(!1)):h(o,n,!0)},R=e=>{if(!c)return;const{x:o,y:n}=z(e);(l==="pencil"||l==="eraser")&&h(o,n,!1)},T=()=>{g(!1)},z=e=>{const o=p.current.getBoundingClientRect();let n,a;return e.touches&&e.touches.length>0?(n=e.touches[0].clientX,a=e.touches[0].clientY):(n=e.clientX,a=e.clientY),{x:Math.floor(n-o.left),y:Math.floor(a-o.top)}},C=(e,o)=>{const n=p.current.getContext("2d",{willReadFrequently:!0}),a=v.current.getContext("2d",{willReadFrequently:!0});K(n,a,e,o,f)},S=(e,o)=>{const n=p.current.getContext("2d");if(k.type==="emoji")n.font="40px serif",n.textAlign="center",n.textBaseline="middle",n.fillText(k.content,e,o);else if(k.type==="image"){const a=new Image;a.src=k.content,a.onload=()=>{n.drawImage(a,e-60/2,o-60/2,60,60)}}},h=(e,o,n)=>{const a=p.current.getContext("2d");a.lineCap="round",a.lineJoin="round",a.lineWidth=y,a.strokeStyle=l==="eraser"?"#ffffff":f,n?(a.beginPath(),a.moveTo(e,o)):(a.lineTo(e,o),a.stroke())},r=()=>{const e=document.createElement("canvas");e.width=p.current.width,e.height=p.current.height;const o=e.getContext("2d");o.drawImage(p.current,0,0),o.drawImage(v.current,0,0);const n=document.createElement("a");n.download="merchboy-masterpiece.png",n.href=e.toDataURL(),n.click()};return t.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"20px"},children:[t.jsxs("div",{style:{display:"flex",gap:"10px",background:"#222",padding:"10px",borderRadius:"50px",border:"2px solid #555"},children:[_.map(e=>t.jsx(E,{onClick:()=>{s(e),d("pencil")},style:{width:"30px",height:"30px",borderRadius:"50%",background:e,border:f===e?"3px solid white":"none"}},e)),t.jsx("label",{style:{width:"30px",height:"30px",borderRadius:"50%",overflow:"hidden",cursor:"pointer",border:"2px solid #555",display:"flex",alignItems:"center",justifyContent:"center"},children:t.jsx("input",{type:"color",value:f,onChange:e=>{s(e.target.value),d("pencil")},style:{width:"150%",height:"150%",padding:0,border:"none",background:"none"}})}),t.jsx("div",{style:{width:"2px",background:"#555"}}),t.jsx(E,{onClick:()=>d("bucket"),style:{background:l==="bucket"?"#444":"transparent",border:"none",fontSize:"1.2rem"},children:"ðŸª£"}),t.jsx(E,{onClick:()=>d("pencil"),style:{background:l==="pencil"?"#444":"transparent",border:"none",fontSize:"1.2rem"},children:"âœï¸"}),t.jsx(E,{onClick:()=>d("eraser"),style:{background:l==="eraser"?"#444":"transparent",border:"none",fontSize:"1.2rem"},children:"ðŸ§¹"}),t.jsx("div",{style:{width:"2px",background:"#555"}}),t.jsx(E,{onClick:()=>d("sticker"),style:{background:l==="sticker"?"#444":"transparent",border:"none",fontSize:"1.2rem"},children:"ðŸ¦„"})]}),l==="sticker"&&t.jsx("div",{style:{display:"flex",gap:"10px",background:"#222",padding:"10px",borderRadius:"20px",border:"2px dashed #555"},children:P.map((e,o)=>t.jsx("button",{onClick:()=>w(e),style:{background:"transparent",border:k===e?"2px solid white":"none",fontSize:"1.5rem",cursor:"pointer",borderRadius:"5px",padding:"5px"},children:e.type==="emoji"?e.content:t.jsx("img",{src:e.content,style:{width:"30px",height:"30px",objectFit:"contain"}})},o))}),t.jsxs("div",{ref:j,style:{position:"relative",width:"100%",maxWidth:"500px",aspectRatio:"1/1",border:"4px solid gold",borderRadius:"10px",background:"white"},children:[t.jsx("canvas",{ref:p,onMouseDown:I,onMouseMove:R,onMouseUp:T,onMouseLeave:T,onTouchStart:e=>{e.preventDefault(),I(e)},onTouchMove:e=>{e.preventDefault(),R(e)},onTouchEnd:e=>{e.preventDefault(),T()},style:{position:"absolute",top:0,left:0,touchAction:"none"}}),t.jsx("canvas",{ref:v,style:{position:"absolute",top:0,left:0,pointerEvents:"none"}})]}),t.jsx(E,{onClick:r,style:{padding:"10px 30px",background:"gold",color:"black",border:"none",borderRadius:"5px",fontWeight:"bold",fontSize:"1.2rem"},children:"SAVE MASTERPIECE ðŸ’¾"})]})},J=[{id:1,src:"/assets/skins/face_money.png",title:"Money Face",cost:0},{id:2,src:"/assets/skins/face_bear.png",title:"Bear Face",cost:0},{id:3,src:"/assets/skins/face_bunny.png",title:"Bunny Face",cost:0},{id:4,src:"/assets/skins/face_default.png",title:"Standard",cost:0}],X=()=>{const[u,m]=x.useState(0),[j,v]=x.useState(JSON.parse(localStorage.getItem("unlockedColoringPages"))||[1]),[p,l]=x.useState(null),[d,f]=x.useState(null),{playWin:s,playBeep:k}=B();x.useEffect(()=>{const i=()=>{const g=parseInt(localStorage.getItem("arcadeCoins"))||0;m(g)};i(),window.addEventListener("storage",i);const c=setInterval(i,1e3);return()=>{window.removeEventListener("storage",i),clearInterval(c)}},[]);const w=i=>{j.includes(i.id)?(l(i),k()):(f(i),k())},y=()=>{if(d)if(u>=d.cost){const i=u-d.cost;localStorage.setItem("arcadeCoins",i),m(i);const c=[...j,d.id];v(c),localStorage.setItem("unlockedColoringPages",JSON.stringify(c)),s(),U(),f(null)}else alert("Insufficient Funds!")};return t.jsxs("div",{className:"page-enter",style:{textAlign:"center",minHeight:"100vh",fontFamily:'"Orbitron", sans-serif',background:"linear-gradient(to bottom, #1a0b2e, #000)",paddingBottom:"150px"},children:[t.jsxs("div",{style:{padding:"20px",marginBottom:"20px"},children:[t.jsx("h2",{style:{fontSize:"2rem",color:"var(--neon-pink)",textShadow:"0 0 10px var(--neon-pink)",margin:0},children:"COLORING STUDIO"}),t.jsxs("p",{style:{color:"#aaa",fontSize:"0.9rem",marginTop:"5px"},children:["WALLET: ",t.jsxs("span",{style:{color:"var(--neon-gold)",fontWeight:"bold"},children:[u.toLocaleString()," ðŸª™"]})]})]}),p?t.jsxs("div",{style:{padding:"0 20px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",maxWidth:"800px",margin:"0 auto 20px auto"},children:[t.jsx(E,{onClick:()=>l(null),style:{padding:"10px 20px",background:"#333",color:"white",border:"1px solid #555",fontSize:"0.9rem"},children:"â¬… BACK TO GALLERY"}),t.jsxs("div",{style:{color:"#888"},children:["EDITING: ",t.jsx("span",{style:{color:"white"},children:p.title.toUpperCase()})]})]}),t.jsx("div",{className:"glass-panel",style:{padding:"20px",display:"inline-block",maxWidth:"100%"},children:t.jsx(G,{templateImage:p.src})})]}):t.jsx("div",{children:t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))",gap:"20px",padding:"0 20px",maxWidth:"1000px",margin:"0 auto"},children:J.map(i=>{const c=j.includes(i.id);return t.jsxs("div",{onClick:()=>w(i),className:"glass-panel",style:{border:c?"1px solid var(--neon-green)":"1px solid #333",padding:"15px",cursor:"pointer",opacity:c?1:.7,transition:"transform 0.2s",position:"relative",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",background:c?"rgba(0, 255, 170, 0.05)":"rgba(0,0,0,0.3)"},onMouseEnter:g=>g.currentTarget.style.transform="scale(1.05)",onMouseLeave:g=>g.currentTarget.style.transform="scale(1)",children:[!c&&t.jsx("div",{style:{position:"absolute",top:"10px",right:"10px",fontSize:"1.5rem",zIndex:10},children:"ðŸ”’"}),t.jsx("div",{style:{background:"white",borderRadius:"8px",padding:"5px",width:"100%"},children:t.jsx("img",{src:i.src,alt:i.title,style:{width:"100%",height:"180px",objectFit:"contain",filter:c?"none":"grayscale(100%) opacity(0.5)"}})}),t.jsx("div",{style:{marginTop:"15px",fontWeight:"bold",color:"white",letterSpacing:"1px"},children:i.title.toUpperCase()}),t.jsx("div",{style:{color:c?"var(--neon-green)":"var(--neon-gold)",marginTop:"5px",fontSize:"0.8rem",fontWeight:"bold"},children:c?"OWNED":`ðŸª™ ${i.cost}`})]},i.id)})})}),d&&!p&&t.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"rgba(0,0,0,0.9)",zIndex:2e3,backdropFilter:"blur(5px)",display:"flex",alignItems:"center",justifyContent:"center"},children:t.jsxs("div",{className:"glass-panel",style:{padding:"40px",border:"1px solid var(--neon-gold)",textAlign:"center",maxWidth:"400px",boxShadow:"0 0 30px rgba(255, 215, 0, 0.2)"},children:[t.jsx("h2",{style:{color:"var(--neon-gold)",margin:0,fontSize:"1.5rem"},children:"UNLOCK TEMPLATE?"}),t.jsx("div",{style:{background:"white",borderRadius:"10px",padding:"10px",margin:"20px 0"},children:t.jsx("img",{src:d.src,style:{width:"100%",height:"200px",objectFit:"contain"}})}),t.jsxs("p",{style:{fontSize:"1.2rem",color:"white",margin:"20px 0"},children:["COST: ",t.jsxs("strong",{style:{color:"var(--neon-gold)"},children:[d.cost," COINS"]})]}),t.jsxs("div",{style:{display:"flex",gap:"20px",justifyContent:"center"},children:[t.jsx(E,{onClick:y,style:{background:"var(--neon-gold)",color:"black",border:"none",padding:"15px 40px",fontWeight:"bold",fontSize:"1.1rem"},children:"UNLOCK"}),t.jsx("button",{onClick:()=>f(null),style:{background:"transparent",color:"#888",border:"1px solid #555",padding:"10px 30px",borderRadius:"20px",cursor:"pointer"},children:"CANCEL"})]})]})})]})};export{X as default};
