import{a as se,r as h,u as ie,j as s,S as k,L as ce,t as J,f as fe}from"./index-BGlGTwyI.js";const p=480,u=800,x=80,b=12,d=24,X=10,de=["/assets/neon_brick/ball1.png","/assets/neon_brick/ball2.png","/assets/neon_brick/ball3.png","/assets/neon_brick/ball4.png"],pe=()=>{const{updateStat:w,incrementStat:Q,shopState:T,addCoins:_,userProfile:ee,stats:I}=se()||{updateStat:()=>{},incrementStat:()=>{},shopState:null},E=h.useRef(null),[y,H]=h.useState(0),[P,O]=h.useState(parseInt(localStorage.getItem("brickHighScore"))||0);h.useEffect(()=>{I?.brickHighScore>P&&O(I.brickHighScore)},[I]);const[D,te]=h.useState(1),[G,W]=h.useState(3),[z,F]=h.useState(!1),[j,N]=h.useState(!1),[$,q]=h.useState({x:0,y:0}),v=h.useRef(!1),A=h.useRef([]),R=h.useRef(null),{playBeep:M,playCrash:ae,playCollect:oe,playWin:V}=ie(),i=h.useRef({paddleX:p/2-x/2,balls:[],bricks:[],powerups:[],particles:[],animationId:null,shakeTime:0});h.useEffect(()=>{de.forEach(e=>{const o=new Image;o.src=e,A.current.push(o)})},[]);const ne=e=>{const o=[],f=p/X,l=25,c=(r,n,g,t=1,a="normal")=>{o.push({x:r*f,y:n*l+80,width:f-4,height:l-4,active:!0,color:g||`hsl(${r*40+n*20}, 100%, 50%)`,value:10*t,hp:t,maxHp:t,type:a})},m=(r,n)=>{r.forEach((g,t)=>{g.split("").forEach((S,C)=>{if(S!==" ")if(S==="S")c(C,t,"#aaa",999,"steel");else{const Z=n(S,C,t);c(C,t,Z.color,Z.hp||1)}})})};if(e===1)for(let r=0;r<5;r++)for(let n=0;n<X;n++)c(n,r,null,1);else if(e===2)for(let r=0;r<14;r++)for(let n=0;n<X;n++)(r+n)%2===0?c(n,r,"#ff0055",1):c(n,r,"#00ff00",1);else if(e===3)m(["SSSSSSSSSS","S        S","S XXXXXX S","S X    X S","S X ^^ X S","S X    X S","S XXXXXX S","S        S","SSSSSSSSSS"],n=>n==="^"?{color:"#ff00aa",hp:2}:{color:"#00ccff",hp:1});else if(e===4)for(let r=0;r<16;r+=2)for(let n=r%4===0?0:1;n<X;n+=2)c(n,r,"#76ff03",r<6?2:1);else if(e===5)m(["   XXXX   "," XXXXXXXX ","XXXXXXXXXX","XX O  O XX","XXXXXXXXXX"," XXXXXXXX ","  XX  XX  ","  XX  XX  ","  XX  XX  "],n=>n==="O"?{color:"#000",hp:1}:{color:"#fff",hp:3});else if(e===6)for(let r=0;r<12;r++)if(r%3===0)for(let n=0;n<X;n++)n%2===0&&c(n,r,"#aaa",999,"steel");else for(let n=0;n<X;n++)c(n,r,"#00bfff",1);else for(let r=0;r<15;r++)for(let n=0;n<X;n++)if(Math.random()>.3){const g=Math.floor(Math.random()*3)+1;c(n,r,`hsl(${Math.random()*360}, 100%, 50%)`,g)}return o},B=(e=5)=>{i.current.shakeTime<=0&&(i.current.shakeTime=10),q({x:(Math.random()-.5)*e,y:(Math.random()-.5)*e}),R.current&&clearTimeout(R.current),R.current=setTimeout(()=>q({x:0,y:0}),100)},K=e=>{te(e);const o=4+e*.5;i.current.balls=[{x:p/2,y:u-40,dx:o*(Math.random()>.5?1:-1),dy:-o,rot:0,imgIndex:Math.floor(Math.random()*4)}],i.current.bricks=ne(e),i.current.paddleX=p/2-x/2,i.current.powerups=[],i.current.particles=[],N(!0),v.current=!0,e===5?Q("brickMaxLevel",5):e>1&&w("brickMaxLevel",f=>Math.max(f,e))},U=()=>{H(0),W(3),F(!1),K(1),requestAnimationFrame(L)},Y=(e,o,f)=>{for(let l=0;l<10;l++)i.current.particles.push({x:e,y:o,dx:(Math.random()-.5)*8,dy:(Math.random()-.5)*8,life:1,color:f})},re=()=>{const e=i.current.paddleX+x/2;for(let o=0;o<4;o++)i.current.balls.push({x:e,y:u-60,dx:(Math.random()-.5)*6,dy:-Math.abs(Math.random()*2+4),rot:0,imgIndex:o});V(),J()},le=e=>{if(N(!1),v.current=!1,F(!0),cancelAnimationFrame(i.current.animationId),y>P&&(O(y),w&&w("brickHighScore",y),y>100)){const o=ee?.name||"Breaker";fe.publish(`smashed a new High Score: ${y} in Neon Bricks ðŸ§±`,"win",o)}_&&_(Math.floor(y/5)),w&&w("gamesPlayed","neon_brick")},L=()=>{if(!v.current)return;const e=E.current.getContext("2d"),o=i.current,{balls:f,paddleX:l}=o;for(let t=f.length-1;t>=0;t--){const a=f[t];if(a.x+=a.dx,a.y+=a.dy,a.rot+=.005,(a.x+d>p||a.x<0)&&(a.dx=-a.dx,M()),a.y<0&&(a.dy=-a.dy,M()),a.y+d>u-b-10&&a.x+d>l&&a.x<l+x){const S=a.x-(l+x/2);a.dx=S*.2,a.dy=-Math.abs(a.dy),M(),navigator.vibrate&&navigator.vibrate(15)}a.y>u&&(f.splice(t,1),B(10),ae())}if(f.length===0)if(G>1)W(t=>t-1),o.balls.push({x:p/2,y:u-40,dx:4*(Math.random()>.5?1:-1),dy:-4,rot:0,imgIndex:Math.floor(Math.random()*4)});else{le();return}let c=0;if(o.bricks.forEach(t=>{t.active&&(c++,o.balls.forEach(a=>{if(a.x<t.x+t.width&&a.x+d>t.x&&a.y<t.y+t.height&&a.y+d>t.y){if(a.dy=-a.dy,t.type==="steel"){M(),B(2);return}t.hp-=1,t.hp<=0?(t.active=!1,H(S=>S+t.value),oe(),Y(t.x+t.width/2,t.y+t.height/2,t.color),B(3),Math.random()<.15&&o.powerups.push({x:t.x+t.width/2,y:t.y,type:"multiball"})):(M(),t.color="white",setTimeout(()=>t.color=t.color,50))}}))}),c===0){J(),V(),setTimeout(()=>{K(D+1),requestAnimationFrame(L)},1e3);return}for(let t=o.powerups.length-1;t>=0;t--){const a=o.powerups[t];a.y+=3,a.y>u-b-10&&a.y<u-10&&a.x>o.paddleX&&a.x<o.paddleX+x?(a.type==="multiball"&&re(),o.powerups.splice(t,1)):a.y>u&&o.powerups.splice(t,1)}for(let t=o.particles.length-1;t>=0;t--){const a=o.particles[t];a.x+=a.dx,a.y+=a.dy,a.life-=.04,a.life<=0&&o.particles.splice(t,1)}e.fillStyle="#111",e.fillRect(0,0,p,u),e.save(),o.particles.forEach(t=>{e.globalAlpha=t.life,e.fillStyle=t.color,e.fillRect(t.x,t.y,5,5)}),e.globalAlpha=1,o.bricks.forEach(t=>{t.active&&(t.type==="steel"?e.fillStyle="#888":(e.fillStyle=t.color,t.hp<t.maxHp&&(e.globalAlpha=.5+.5*(t.hp/t.maxHp))),e.shadowBlur=10,e.shadowColor=t.color,e.fillRect(t.x,t.y,t.width,t.height),e.shadowBlur=0,e.globalAlpha=1,t.hp>1&&t.type!=="steel"&&(e.fillStyle="white",e.font="10px Arial",e.fillText(t.hp,t.x+t.width/2,t.y+t.height/2+3)))}),e.font="24px serif",e.textAlign="center",o.powerups.forEach(t=>e.fillText("âš¡",t.x,t.y));const m=T?.equipped?.brick||"paddle_default";let r="#00ffaa",n="#00ffaa";m==="paddle_flame"?(r="#ff4500",n="#ff8c00"):m==="paddle_ice"?(r="#00bfff",n="#e0ffff"):m==="paddle_laser"&&(r="#00ff00",n="#00ffff"),e.fillStyle=r,e.shadowBlur=20,e.shadowColor=n,e.fillRect(o.paddleX,u-b-10,x,b),m==="paddle_flame"&&(e.fillStyle="yellow",e.fillRect(o.paddleX+10,u-b-5,x-20,2)),e.shadowBlur=0;const g=T?.equipped?.brick_ball||"ball_std";o.balls.forEach(t=>{if(e.save(),e.translate(t.x+d/2,t.y+d/2),e.rotate(t.rot),g==="ball_eye")e.fillStyle="white",e.beginPath(),e.arc(0,0,d/2,0,Math.PI*2),e.fill(),e.fillStyle="#00aaff",e.beginPath(),e.arc(0,0,d/4,0,Math.PI*2),e.fill(),e.fillStyle="black",e.beginPath(),e.arc(0,0,d/8,0,Math.PI*2),e.fill();else if(g==="ball_fire")e.fillStyle="#ff4500",e.shadowBlur=10,e.shadowColor="orange",e.beginPath(),e.arc(0,0,d/2,0,Math.PI*2),e.fill(),Math.random()>.5&&Y(t.x,t.y+10,"orange");else{const a=A.current[t.imgIndex%A.current.length];a&&a.complete?(e.shadowBlur=10,e.shadowColor="rgba(255,255,255,0.5)",e.drawImage(a,-d/2,-d/2,d,d),e.shadowBlur=0):(e.fillStyle="white",e.beginPath(),e.arc(0,0,d/2,0,Math.PI*2),e.fill())}e.restore()}),e.restore(),o.animationId=requestAnimationFrame(L)};return h.useEffect(()=>{const e=l=>{if(!v.current)return;const c=E.current.getBoundingClientRect(),m=p/c.width,r=(l-c.left)*m;i.current.paddleX=Math.max(0,Math.min(p-x,r-x/2))},o=l=>{e(l.clientX)},f=l=>{if(!v.current)return;const c=40;(l.key==="ArrowLeft"||l.key==="a"||l.key==="A")&&(i.current.paddleX=Math.max(0,i.current.paddleX-c)),(l.key==="ArrowRight"||l.key==="d"||l.key==="D")&&(i.current.paddleX=Math.min(p-x,i.current.paddleX+c))};return window.addEventListener("mousemove",o),window.addEventListener("keydown",f),()=>{window.removeEventListener("mousemove",o),window.removeEventListener("keydown",f)}},[]),s.jsxs("div",{style:{position:"fixed",inset:0,background:"#050505",touchAction:"none",overflow:"hidden",cursor:j?"none":"default",fontFamily:'"Orbitron", sans-serif'},onTouchMove:e=>{if(j){const o=E.current.getBoundingClientRect(),f=p/o.width,l=(e.touches[0].clientX-o.left)*f;i.current.paddleX=Math.max(0,Math.min(p-x,l-x/2))}},children:[s.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",backgroundImage:"radial-gradient(circle at 50% 50%, #1a0b2e 0%, #000 100%)",zIndex:-1}}),s.jsxs("div",{style:{position:"absolute",top:10,width:"100%",display:"flex",justifyContent:"space-between",padding:"0 30px",color:"var(--neon-pink)",fontSize:"1.2rem",zIndex:10,textShadow:"0 0 10px var(--neon-pink)",fontWeight:"bold"},children:[s.jsxs("span",{children:["SCORE: ",y]}),s.jsxs("span",{style:{color:"white"},children:["LVL ",D]}),s.jsxs("span",{style:{color:"var(--neon-green)"},children:["LIVES: ",G]})]}),s.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100vh",transform:`translate(${$.x}px, ${$.y}px)`,transition:"transform 0.05s"},children:s.jsxs("div",{style:{position:"relative",boxShadow:"0 0 50px rgba(255, 0, 85, 0.2)",border:"2px solid var(--neon-blue)",borderRadius:"8px",background:"#000"},children:[s.jsx("canvas",{ref:E,width:p,height:u,style:{display:"block",maxWidth:"95vw",maxHeight:"85vh",aspectRatio:`${p}/${u}`,width:"auto",height:"auto"}}),!j&&!z&&s.jsxs("div",{style:{position:"absolute",inset:0,background:"rgba(0,0,0,0.7)",backdropFilter:"blur(8px)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[s.jsxs("h1",{style:{color:"var(--neon-pink)",fontSize:"4rem",textAlign:"center",textShadow:"0 0 30px var(--neon-pink)",lineHeight:"1",marginBottom:"2rem",letterSpacing:"4px"},children:["NEON",s.jsx("br",{}),"BRICKS"]}),s.jsx(k,{onClick:U,style:{padding:"15px 50px",fontSize:"1.5rem",background:"var(--neon-green)",color:"black",border:"none",fontWeight:"900",boxShadow:"0 0 20px var(--neon-green)"},children:"PLAY NOW"}),s.jsx("p",{style:{marginTop:"20px",color:"#888",fontSize:"0.8rem",letterSpacing:"2px"},children:"MOUSE / TOUCH TO MOVE"})]}),z&&s.jsxs("div",{style:{position:"absolute",inset:0,background:"rgba(0,0,0,0.85)",backdropFilter:"blur(10px)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[s.jsx("h2",{style:{fontSize:"3.5rem",color:"#ff0055",textShadow:"0 0 20px red",marginBottom:"10px"},children:"GAME OVER"}),s.jsxs("p",{style:{fontSize:"1.5rem",color:"white",marginBottom:"30px"},children:["FINAL SCORE: ",s.jsx("span",{style:{color:"var(--neon-green)"},children:y})]}),s.jsxs("div",{style:{display:"flex",gap:"20px"},children:[s.jsx(k,{onClick:U,style:{background:"var(--neon-blue)",color:"black",fontWeight:"bold"},children:"RETRY"}),s.jsx(ce,{to:"/arcade",children:s.jsx(k,{style:{background:"#333",color:"#fff"},children:"EXIT"})})]})]})]})})]})};export{pe as default};
