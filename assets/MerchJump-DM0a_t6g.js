import{r as i,u as X,a as V,j as n,S as N,L as $,f as K}from"./index-BGlGTwyI.js";import{G as Q}from"./GameOverCard-Cna3_-75.js";const d=[{name:"STREETS",limit:2500,bgTop:"#87CEEB",bgBot:"#E0F7FA",plat:"#999",text:"#333",border:"#666"},{name:"SUNSET WAVE",limit:5e3,bgTop:"#ff7e5f",bgBot:"#feb47b",plat:"#554433",text:"white",border:"#332211"},{name:"CYBER CITY",limit:7500,bgTop:"#2b1055",bgBot:"#7597de",plat:"#00ffaa",text:"#00ffaa",border:"white"},{name:"GLITCH REALM",limit:1e4,bgTop:"#000000",bgBot:"#111111",plat:"#00ff00",text:"#00ff00",border:"lime",glitch:!0},{name:"ASCENSION",limit:999999,bgTop:"#FFD700",bgBot:"#FFFFFF",plat:"#FFFFFF",text:"#B8860B",border:"#FFD700"}],re=()=>{const p=i.useRef(null),{playJump:Y,playCrash:L,playBoop:W}=X(),{updateStat:y,addCoins:w,userProfile:_,stats:T}=V()||{};i.useEffect(()=>{T?.merchJumpHighScore>x&&k(T.merchJumpHighScore)},[T]);const z=.4,J=-12,s=400,a=600,C=[{id:"face_money",name:"MONEY",src:"/assets/skins/face_money.png?t=v2",hoodie:"#111"},{id:"face_bear",name:"BEAR",src:"/assets/skins/face_bear.png?t=v2",hoodie:"#593a28"},{id:"face_bunny",name:"BUNNY",src:"/assets/skins/face_bunny.png?t=v2",hoodie:"#7cb9e8"},{id:"face_default",name:"OG",src:"/assets/skins/face_default.png?t=v2",hoodie:"#333"}],[I,F]=i.useState("MENU"),[Z,B]=i.useState(0),[x,k]=i.useState(parseInt(localStorage.getItem("merchJumpHighScore"))||0),[h,O]=i.useState(C[0]),P=i.useRef({x:s/2,y:a-150,vy:0,width:40,height:60}),c=i.useRef([]),b=i.useRef(0),u=i.useRef(0),E=i.useRef(null),M=i.useRef(s/2),S=i.useRef(null),j=i.useRef(d[0]);i.useEffect(()=>{const e=new Image;return e.crossOrigin="Anonymous",e.src=h.src,S.current=e,()=>cancelAnimationFrame(E.current)},[h]);const D=e=>{for(let r of d)if(e<r.limit)return r;return d[d.length-1]},A=()=>{B(0),u.current=0,b.current=0,j.current=d[0],P.current={x:s/2,y:a-150,vy:0,width:40,height:60},c.current=[],c.current.push({x:s/2-50,y:a-50,w:100,h:20,type:"normal",color:d[0].plat,border:d[0].border});let e=a-200;for(let r=0;r<15;r++)G(e,d[0]),e-=80+Math.random()*40;F("PLAYING"),E.current=requestAnimationFrame(H)},G=(e,r)=>{const o=Math.random()*(s-80);c.current.push({x:o,y:e,w:70+Math.random()*30,h:15,type:Math.random()>.8?"moving":"normal",vx:Math.random()>.5?2:-2,color:r.plat,border:r.border})},U=(e,r,o,f,g)=>{const R=performance.now()*.01;e.save(),e.translate(r,o),e.rotate(g*.2),e.fillStyle="#ccc",e.fillRect(-15,-10,10,30),e.fillRect(5,-10,10,30),f<0&&(e.fillStyle="#ff9900",e.beginPath(),e.moveTo(-10,20),e.lineTo(-5,35+Math.random()*10),e.lineTo(0,20),e.moveTo(10,20),e.lineTo(15,35+Math.random()*10),e.lineTo(5,20),e.fill()),e.fillStyle="#222";const t=f<0?30:30+Math.abs(Math.sin(R)*5),l=f<0?35:30+Math.abs(Math.cos(R)*5);e.beginPath(),e.moveTo(-10,20),e.quadraticCurveTo(-15,25,-12,t),e.lineWidth=6,e.strokeStyle="#222",e.stroke(),e.beginPath(),e.moveTo(10,20),e.quadraticCurveTo(15,25,12,l),e.stroke(),e.fillStyle="white",e.fillRect(-16,t,8,5),e.fillRect(8,l,8,5),e.fillStyle=h.hoodie||"#111",e.beginPath(),e.roundRect(-20,0,40,35,10),e.fill(),e.fillStyle="white",e.font="10px sans-serif",e.fillText("M",-5,20),e.strokeStyle=h.hoodie||"#111",e.lineWidth=8,e.lineCap="round",e.beginPath(),e.moveTo(-18,5),e.lineTo(-30,f<0?-10:15),e.stroke(),e.beginPath(),e.moveTo(18,5),e.lineTo(30,f<0?-10:15),e.stroke(),S.current&&S.current.complete?e.drawImage(S.current,-50/2,-50/2-15,50,50):(e.fillStyle="white",e.beginPath(),e.arc(0,-20,20,0,Math.PI*2),e.fill()),e.restore()},H=()=>{if(!p.current)return;const e=p.current.getContext("2d"),r=P.current,o=D(u.current);j.current=o;const f=M.current;if(r.x+=(f-r.x)*.15,r.x<-20&&(r.x=s+20),r.x>s+20&&(r.x=-20),r.vy+=z,r.y+=r.vy,r.y<a/2){const t=a/2-r.y;r.y=a/2,b.current+=t,u.current+=Math.floor(t),B(u.current),c.current.forEach(m=>m.y+=t),c.current=c.current.filter(m=>m.y<a);const l=c.current[c.current.length-1];l&&l.y>100&&G(l.y-(80+Math.random()*40),o)}if(r.vy>0&&c.current.forEach(t=>{r.x>t.x-20&&r.x<t.x+t.w+20&&r.y+30>t.y&&r.y+30<t.y+t.h+20&&(r.vy=J,Y())}),c.current.forEach(t=>{t.type==="moving"&&(t.x+=t.vx,(t.x<=0||t.x+t.w>=s)&&(t.vx*=-1))}),r.y>a){q();return}const g=e.createLinearGradient(0,0,0,a);if(g.addColorStop(0,o.bgTop),g.addColorStop(1,o.bgBot),e.fillStyle=g,e.fillRect(0,0,s,a),o.glitch&&Math.random()>.95&&(e.save(),e.translate((Math.random()-.5)*10,0),Math.random()>.5&&(e.filter="invert(1)")),o.name==="STREETS"||o.name==="SUNSET WAVE"){e.fillStyle="rgba(255, 255, 255, 0.4)";for(let t=0;t<5;t++){const l=(t*100+b.current*.2)%(s+200)-100,m=t*150%a;e.beginPath(),e.arc(l,m,40,0,Math.PI*2),e.arc(l+40,m+10,50,0,Math.PI*2),e.fill()}}else if(o.name==="CYBER CITY"||o.name==="GLITCH REALM"){e.strokeStyle="rgba(0, 255, 255, 0.2)",e.lineWidth=2;const t=b.current*.5%100;for(let l=t;l<a;l+=100)e.beginPath(),e.moveTo(0,l),e.lineTo(s,l),e.stroke()}c.current.forEach(t=>{e.fillStyle=t.color||o.plat,e.fillRect(t.x,t.y,t.w,t.h),e.fillStyle="rgba(255,255,255,0.3)",e.fillRect(t.x,t.y,t.w,4),e.strokeStyle=t.border||o.border,e.lineWidth=2,e.strokeRect(t.x,t.y,t.w,t.h)});const R=(M.current-r.x)*.05;U(e,r.x,r.y,r.vy,R),e.fillStyle=o.text,e.font="bold 20px monospace",e.textAlign="left",e.fillText(`${o.name}`,10,30),e.fillText(`${Math.floor(u.current)}m`,10,50),o.glitch&&Math.random()>.95&&e.restore(),E.current=requestAnimationFrame(H)},q=()=>{F("GAMEOVER"),L();const e=Math.floor(u.current);if(w&&w(Math.floor(e/100)),y&&y("gamesPlayed","merch_jump"),e>x){k(e),y&&y("merchJumpHighScore",e);const r=_?.name||"Player";K.publish(`set a new Merch Jump High Score: ${e}m! üöÄ`,"win",r)}},v=e=>{const r=p.current.getBoundingClientRect(),o=s/r.width;let f=e.touches?e.touches[0].clientX:e.clientX;M.current=(f-r.left)*o};return n.jsxs("div",{className:"page-enter",style:{minHeight:"100vh",background:"#222",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",fontFamily:"sans-serif",touchAction:"none"},children:[n.jsx("h1",{style:{color:"white",marginBottom:"10px",fontSize:"1.5rem",fontWeight:"bold"},children:"MERCH JUMP"}),n.jsxs("div",{style:{position:"relative",width:"100%",maxWidth:"400px",aspectRatio:"2/3"},children:[n.jsx("canvas",{ref:p,width:s,height:a,onMouseMove:v,onTouchMove:e=>{e.preventDefault(),v(e)},onTouchStart:v,style:{width:"100%",height:"100%",background:"#87CEEB",border:"4px solid white",borderRadius:"10px",boxShadow:"0 10px 30px rgba(0,0,0,0.3)"}}),I!=="PLAYING"&&n.jsx(n.Fragment,{children:I==="GAMEOVER"?n.jsx(Q,{score:Math.floor(u.current),bestScore:x,gameId:"merch_jump",onReplay:A,onHome:()=>window.location.href="/arcade"}):n.jsxs("div",{style:{position:"absolute",inset:0,background:"rgba(255,255,255,0.9)",backdropFilter:"blur(5px)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",color:"#333",borderRadius:"10px"},children:[n.jsxs("div",{style:{marginBottom:"20px",textAlign:"center"},children:[n.jsx("p",{style:{fontWeight:"bold",marginBottom:"10px"},children:"SELECT DRIP:"}),n.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px"},children:C.map(e=>n.jsx("button",{onClick:()=>{O(e),W()},style:{background:h.id===e.id?"#87CEEB":"#eee",border:"none",borderRadius:"10px",padding:"10px",cursor:"pointer",transform:h.id===e.id?"scale(1.1)":"scale(1)",boxShadow:h.id===e.id?"0 5px 15px rgba(0,0,0,0.1)":"none"},children:n.jsx("img",{src:e.src,width:"40",height:"40",style:{display:"block",margin:"0 auto"}})},e.id))})]}),n.jsx(N,{onClick:A,style:{padding:"20px 50px",background:"#333",color:"white",fontWeight:"bold",fontSize:"1.2rem",border:"none",borderRadius:"100px"},children:"JUMP"})]})})]}),n.jsx("p",{style:{color:"#888",marginTop:"20px",fontSize:"0.8rem"},children:"Slide to Move ‚Ä¢ Reach 2500m for Next Biome"}),n.jsx($,{to:"/arcade",style:{position:"absolute",top:"20px",left:"20px",zIndex:100},children:n.jsx(N,{style:{borderRadius:"50px",padding:"10px 20px",fontSize:"1.2rem",background:"rgba(255,255,255,0.2)",backdropFilter:"blur(5px)"},children:"üè† EXIT"})})]})};export{re as default};
